# 端口占用错误说明

## 你看到的错误

```
ERROR: [Errno 10048] error while attempting to bind on address ('127.0.0.1', 8001): 
only one usage of each socket address (protocol/network address/port) is normally permitted
```

## 这是什么意思？

**端口 8001 已经被占用了**

- 可能有另一个服务器实例在运行
- 或者之前的服务器没有完全关闭

## 解决方案

### 方法 1: 停止占用端口的进程（推荐）

在 PowerShell 中运行：
```powershell
# 查找并停止占用 8001 端口的进程
Get-NetTCPConnection -LocalPort 8001 -ErrorAction SilentlyContinue | 
    Select-Object -ExpandProperty OwningProcess -Unique | 
    ForEach-Object { Stop-Process -Id $_ -Force }
```

或者停止所有 Python 进程：
```powershell
Get-Process python | Stop-Process -Force
```

### 方法 2: 使用自动端口选择（已修复）

我已经更新了 `run_fresh.py`，现在它会：
1. 先尝试端口 8002
2. 如果被占用，尝试 8001
3. 如果还是被占用，尝试 8000
4. 自动选择第一个可用的端口

直接运行：
```bash
python run_fresh.py
```

服务器会自动找到可用端口并显示给你。

### 方法 3: 手动指定端口

编辑 `run_fresh.py`，找到这一行：
```python
port=8001,
```

改成其他端口，比如：
```python
port=8003,  # 或其他未被占用的端口
```

## 检查哪些端口被占用

运行：
```powershell
netstat -ano | findstr LISTENING | findstr "800"
```

这会显示所有 800x 端口的占用情况。

## 推荐操作

1. **停止所有 Python 进程**：
   ```powershell
   Get-Process python | Stop-Process -Force
   ```

2. **等待 5 秒**

3. **启动服务器**（现在会自动找可用端口）：
   ```bash
   python run_fresh.py
   ```

4. **查看启动日志**，会显示使用的端口号

